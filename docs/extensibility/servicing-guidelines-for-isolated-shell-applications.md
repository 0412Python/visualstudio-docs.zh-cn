---
title: "独立的 Shell 应用程序的服务指南 | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Visual Studio Shell 集成模式下，可维护性"
  - "Shell 集成的模式 [Visual Studio]，可维护性"
ms.assetid: 747d1a47-b8b3-4e8b-93c0-768724be48f2
caps.latest.revision: 15
caps.handback.revision: 15
ms.author: "gregvanl"
manager: "ghogen"
---
# 独立的 Shell 应用程序的服务指南
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

分发隔离的 Visual Studio shell 应用程序时，您必须能够安装后为您的应用程序提供软件更新。 要执行此操作，必须通过使用 Microsoft Installer \(MSI\) 文件安装应用程序。 这种安装允许由 Microsoft 进行重新分配由 Web 提供的软件更新下载并由您的客户而无需自定义的干预。  
  
## 服务要求  
 您可以确保您的独立的 shell 安装，可以通过确保您的安装程序满足以下三个条件，从而允许更新。  
  
### 通过使用 MSI 重新分发  
 您必须使用 MSI 重新发布您的应用程序，因为 MSI 可以保留产品标识，并可确保应用程序具有客户端计算机上的物理位置。 合并模块 （.msm 文件） 不提供此类保证，不应使用。  
  
### 自定义操作的记帐  
 自定义操作均在安装程序中的使用了非标准安装指令。 自定义操作更改参数，如文件位置、 注册表设置、 用户设置或安装的其他项。 自定义操作可能会在安装时处理数据。  
  
 当您在安装程序中使用自定义操作时，必须确保每个安装时自定义操作必须具有相应的自定义操作要撤消的操作，当用户卸载应用程序。 如果安装程序无法正常工作以提供相应卸载自定义操作，请删除您的应用程序将离开它部分安装。  
  
-   软件更新更改这些版本或哈希值时，依赖于特定版本的文件或哈希值的自定义操作将失败。 在这种情况下自定义操作必须手动更新这些值。 如果产品版本间共享的文件或哈希值的版本，则会发生另一个问题。 避免此依赖关系，只要有可能。  
  
### 记帐共享文件  
 共享的文件具有相同的名称，并且可以由多个产品安装到同一位置。 这些产品的版本和 \/ 或库存单位 \(SKU\)，可能会不同，产品可以在给定计算机上共存。 但是，共享的文件有几个原因造成服务的问题︰  
  
-   更新共享的文件会导致应用程序兼容性问题，因为对一个应用程序的更新可能会更改使用的第二个应用程序尚未更新的文件的版本。 安装程序共享文件的产品计数对共享文件的引用。 因此，卸载产品不会影响共享文件递减已安装的实例计数之外的文件。  
  
-   快速修复工程 \(QFE\) 安装程序将恢复到的 QFE 安装程序提供服务的产品版本的文件的版本。 此过程可能会中断应用程序传送已更新的共享的文件。