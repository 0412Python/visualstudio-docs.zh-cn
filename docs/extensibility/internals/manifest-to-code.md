---
title: "代码清单 |Microsoft 文档"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 17ecacea-397d-4a97-b003-01bd5d56e936
caps.latest.revision: "4"
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.openlocfilehash: dd693d56011173564650c0abbd2d5d73492d335d
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/31/2017
---
# <a name="manifest-to-code"></a>代码清单
代码工具清单是一个控制台应用程序，它为 Visual Studio 映像服务接受.imagemanifest 文件并生成包装文件或文件引用 c + +、 C#、 VB 或 Visual Studio 扩展的.vsct 文件中的图像清单的值。 此工具会生成可用于请求映像从 Visual Studio 映像服务直接，或用于通过 Api 的清单值传递，如果代码不处理任何其自己的 UI 和呈现的包装器文件。  
  
## <a name="how-to-use-the-tool"></a>如何使用该工具  
 **语法**  
  
 ManifestToCode /manifest:\<映像清单文件 > /language:\<代码语言 >\<可选参数 >  
  
 **参数**  
  
||||  
|-|-|-|  
|**交换机名称**|**注意**|**必需或可选**|  
|/manifest|图像清单要用于创建或更新代码包装的路径。|必需|  
|/language|所使用的语言生成代码包装。<br /><br /> 有效值： CPP、 c + +、 CS、 CSharp、 C#、 VB 或 VSCT 值不区分大小写。<br /><br /> VSCT 语言将忽略选项、 /monikerClass、 /classAccess 和 /namespace 选项。|必需|  
|/imageIdClass|ImageIdClass 和关联的工具创建的文件的名称。 C + + 语言选项时，生成仅.h 文件。<br /><br /> 默认值：\<清单路径 > \MyImageIds。\<Lang Ext >|Optional|  
|/monikerClass|MonikerClass 和关联的工具创建的文件的名称。 C + + 语言选项时，生成仅.h 文件。 这将被忽略的 VSCT 语言。<br /><br /> 默认值：\<清单路径 > \MyMonikers。\<Lang Ext >|Optional|  
|/classAccess|ImageIdClass 和 monikerClass 访问修饰符。 请确保访问修饰符为给定语言有效。 这将被忽略 VSCT 语言选项。<br /><br /> 默认： 公共|Optional|  
|/namespace|在代码包装中定义的命名空间。 这将被忽略 VSCT 语言选项。 是。 ':: 是有效的命名空间分隔符，无论何种选择的语言选项。<br /><br /> 默认： MyImages|Optional|  
|/noLogo|设置此标志将停止打印的产品和版权信息。|Optional|  
|/?|打印出帮助信息。|Optional|  
|/help|打印出帮助信息。|Optional|  
  
 **示例**  
  
-   ManifestToCode /manifest:D:\MyManifest.imagemanifest /language:CSharp  
  
-   ManifestToCode /manifest:D:\MyManifest.imagemanifest /language:C++ /namespace： 我:: Namespace /imageIdClass:MyImageIds /monikerClass:MyMonikers /classAccess:friend  
  
-   ManifestToCode /manifest:D:\MyManifest.imagemanifest /language:VSCT /imageIdClass:MyImageIds  
  
## <a name="notes"></a>说明  
  
-   我们建议使用图像的清单生成清单从资源工具使用此工具。  
  
-   该工具仅查找符号条目生成代码包装。 如果图像清单包含无符号，生成的代码包装器将为空。 如果没有图像或组图像清单中的映像，请不要使用符号，然后它们将从中排除代码包装。  
  
## <a name="sample-output"></a>示例输出  
 **C# 包装**  
  
 一对简单的映像 ID 和映像名字对象类的 C# 将类似于下面的代码：  
  
```csharp  
//-----------------------------------------------------------------------------  
// <auto-generated>  
//     This code was generated by the ManifestToCode tool.  
//     Tool Version: 14.0.15198  
// </auto-generated>  
//-----------------------------------------------------------------------------  
  
using System;  
  
namespace MyImages  
{  
    public static class MyImageIds  
    {  
        public static readonly Guid AssetsGuid = new Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}");  
  
        public const int MyImage1 = 0;  
        public const int MyImage2 = 1;  
    }  
}  
//-----------------------------------------------------------------------------  
// <auto-generated>  
//     This code was generated by the ManifestToCode tool.  
//     Tool Version: 14.0.15198  
// </auto-generated>  
//-----------------------------------------------------------------------------  
  
using Microsoft.VisualStudio.Imaging.Interop;  
  
namespace MyImages  
{  
    public static class MyMonikers  
    {  
        public static ImageMoniker MyImage1 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage1 }; } }  
        public static ImageMoniker MyImage2 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage2 }; } }  
    }  
}  
```  
  
 **C + + 包装器**  
  
 一对简单的映像 ID 和映像名字对象类的 c + + 将类似于下面的代码：  
  
```cpp  
//-----------------------------------------------------------------------------  
// <auto-generated>  
//     This code was generated by the ManifestToCode tool.  
//     Tool Version: 14.0.15198  
// </auto-generated>  
//-----------------------------------------------------------------------------  
  
#pragma once  
  
#include <guiddef.h>  
  
namespace MyImages {  
  
class MyImageIds {  
public:  
  
    static const GUID AssetsGuid;  
  
    static const int MyImage1 = 0;  
    static const int MyImage2 = 1;  
  
};  
  
__declspec(selectany) const GUID MyImageIds::AssetsGuid = {0x442d8739,0xefde,0x46a4,{0x8f,0x29,0xe3,0xa1,0xe5,0xe7,0xf8,0xb4}};  
  
}  
//-----------------------------------------------------------------------------  
// <auto-generated>  
//     This code was generated by the ManifestToCode tool.  
//     Tool Version: 14.0.15198  
// </auto-generated>  
//-----------------------------------------------------------------------------  
  
#pragma once  
  
#include "ImageParameters140.h"  
#include "MyImageIds.h"  
  
namespace MyImages {  
  
class MyMonikers {  
public:  
  
    static const ImageMoniker MyImage1;  
    static const ImageMoniker MyImage2;  
  
};  
  
__declspec(selectany) const ImageMoniker MyMonikers::MyImage1 = { MyImageIds::AssetsGuid, MyImageIds::MyImage1 };  
__declspec(selectany) const ImageMoniker MyMonikers::MyImage2 = { MyImageIds::AssetsGuid, MyImageIds::MyImage2 };  
  
}  
```  
  
 **Visual Basic 包装**  
  
 一对简单的映像 ID 和映像名字对象类的 Visual Basic 将类似于下面的代码：  
  
```vb  
' -----------------------------------------------------------------------------  
'  <auto-generated>  
'      This code was generated by the ManifestToCode tool.  
'      Tool Version: 14.0.15198  
'  </auto-generated>  
' -----------------------------------------------------------------------------  
  
Imports System  
  
Namespace MyImages  
  
    Public Module MyImageIds  
  
        Public Shared ReadOnly AssetsGuid As Guid = New Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}")  
  
        Public Const MyImage1 As Integer = 0  
        Public Const MyImage2 As Integer = 1  
  
    End Module  
  
End Namespace  
' -----------------------------------------------------------------------------  
'  <auto-generated>  
'      This code was generated by the ManifestToCode tool.  
'      Tool Version: 14.0.15198  
'  </auto-generated>  
' -----------------------------------------------------------------------------  
  
Imports Microsoft.VisualStudio.Imaging.Interop  
  
Namespace MyImages  
  
    Public Module MyMonikers  
  
        Public Readonly Property MyImage1  
            Get  
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage1}  
            End Get  
        End Property  
  
        Public Readonly Property MyImage2  
            Get  
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage2}  
            End Get  
        End Property  
  
    End Module  
  
End Namespace  
```  
  
 **VSCT 包装**  
  
 映像 Id.vsct 文件的一组将类似于此：  
  
```xml  
<?xml version='1.0' encoding='utf-8'?>  
<!--  
 [auto-generated]  
     This code was generated by the ManifestToCode tool.  
     Tool Version: 14.0.15198  
 [/auto-generated]  
-->  
<CommandTable xmlns="http://schemas.microsoft.com/VisualStudio/2005-10-18/CommandTable">  
  <Symbols>  
    <GuidSymbol name="AssetsGuid" value="{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}">  
      <IDSymbol name="MyImage1" value="0" />  
      <IDSymbol name="MyImage2" value="1" />  
    </GuidSymbol>  
  </Symbols>  
</CommandTable>  
```