---
title: 调试 T4 文本模板 |Microsoft 文档
ms.custom: ''
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, troubleshooting
- text templates, debugging
author: gewarren
ms.author: gewarren
manager: douge
ms.workload:
- multiple
ms.technology: vs-ide-modeling
ms.openlocfilehash: 86d8bb0fafefab8a0273012ed8e45b44c31eac47
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/16/2018
---
# <a name="debugging-a-t4-text-template"></a>调试 T4 文本模板
你可以在文本模板中设置断点。 要调试的设计时文本模板，将文本模板文件，保存，然后选择**调试 T4 模板**解决方案资源管理器中的文件的快捷菜单上。 若要调试的运行时文本模板，只需调试它属于该应用程序。  
  
 若要调试文本模板，你应该了解模板转换过程的步骤。 不同种类的错误会在每个步骤。 步骤如下所示。  
  
|步骤|设计时模板： 发生时|运行时模板： 发生时|  
|----------|--------------------------------------------|-----------------------------------------|  
|从文本模板生成代码。<br /><br /> 指令中的错误或不匹配或 disordered`<#...#>`标记。|当你保存模板，或调用文本转换。|当你保存模板，或调用文本转换。|  
|生成的代码会编译。<br /><br /> 模板代码中的编译错误。|紧跟上一步。|以及应用程序代码。|  
|代码运行。<br /><br /> 模板代码中的运行时错误。|紧跟上一步。|当你的应用程序运行，并且调用模板代码。|  
  
 在大多数情况下，错误报告中提供模板的代码中的行号。 当错误报告引用临时文件名时，原因通常是在文本模板的代码中的括号不匹配。  
  
 你可在文本模板中设置断点和调试按照通常的方式。  
  
## <a name="common-errors-and-fixes"></a>常见错误和修补程序  
 下表列出最常见的错误和其修补程序。  
  
|错误消息|描述|解决方案|  
|-------------------|-----------------|--------------|  
|未能加载从哪个转换类继承的基类"{0}"。|如果找不到中指定的基类则会发生`inherits`模板指令中的参数。 消息可提供模板指令的行号。|请确保存在指定的类，以及它存在于程序集，一个程序集指令中指定。|  
|未能解析包括文本 file:{0}|找不到包含的模板时发生。 消息可提供该请求的包含文件的名称。|请确保文件路径是相对于原始的模板路径，或该文件位于与主机注册的位置或存在该文件的完整路径。|  
|在初始化转换对象时生成错误。 转换将不会运行。|Initialize （） 的转换类失败或返回了 false 时发生。|Initialize （） 函数中的代码来自中指定的基转换类\<#@template#> 指令，并且从指令处理器。 导致初始化失败可能的错误是在错误列表。 调查失败的原因。 你可以查看实际生成的代码为 initialize （） 通过执行以下过程来调试模板。|  
|程序集"{0}"指令处理器 {1} 未被授予 FullTrust 权限集。 只有受信任的程序集可以提供指令处理器。 此指令处理器将不加载。|系统不会包含指令处理器的程序集授予 FullTrust 权限时发生。 消息可提供程序集的名称和指令处理器的名称。|请确保你仅在本地计算机上使用受信任的程序集。|  
|路径"{0}"必须是此计算机的本地或受信任区域的一部分。|当指令或程序集指令引用的文件，不在本地计算机或网络的受信任区域上，则会出现。|请确保指令或程序集指令所在位置的目录是在受信任区域中。 可以将网络目录添加到受信任区域中，通过 Internet 资源管理器。|  
|如"无效令牌 catch"或"命名空间不能直接包含成员"的多个语法错误|模板代码中的右括号太多。 编译器为混淆它与标准的生成代码。|检查的右大括号和代码分隔符内的括号的数量。|  
|循环或条件语句不编译或正确执行。 例如：`<#if (i>10)#> Number is: <#= i #>`。<br /><br /> 此代码始终输出的值我。 仅"数是:"有条件。|在 C# 中，始终使用大括号来括住控制语句中嵌入的文本块。|添加大括号： `<#if (i>10) { #>    Number is: <#= i #><# } #>`。|  
|"表达式太复杂"时处理的设计时模板，或编译运行时 （预处理过的） 模板。<br /><br /> [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] 尝试检查由运行时模板生成的代码时停止工作。|文本块过长。 T4 将文本块转换为具有一个字符串为每个模板行文本的字符串串联表达式。 很长的文本块可以超越编译器的大小限制。|分解如将表达式块的长文本块：<br /><br /> `<#= "" #>`|  
  
## <a name="warning-descriptions-and-fixes"></a>警告说明和修补程序  
 下表列出最常见的警告，以及修补程序，如果可用。  
  
|警告消息|描述|解决方案|  
|---------------------|-----------------|--------------|  
|加载包含文件"{0}"返回了 null 或空字符串。|如果包含的文本模板文件为空，则会发生。 消息可提供所包含的文件的文件名。|请删除 include 指令，或确保该文件具有一些内容。|  
|编译转换：|此将字符串追加到所有的错误或警告源自编译器在编译转换时。 此字符串意味着编译器引发了错误或警告。|如果你有查找 DLL 的问题，你可能需要提供的完整路径或完全限定的强名称，如果 DLL 是在 gac 中。|  
|在指令中已存在参数"{0}"。 将忽略重复的参数。|指令中多次指定参数时发生。 消息可提供参数和指令的行号的名称。|删除重复的参数规范。|  
|没有加载包含文件"{0}"时出错。 Include 指令将被忽略。|找不到在指定的文件时发生`include`指令。 消息可提供的文件和指令的行号的名称。|请确保包含文件存在于原始文本模板文件所在的目录或向主机注册的 include 目录之一中。|  
|为转换类指定一个无效的基类。 基的类必须派生自 Microsoft.VisualStudio.TextTemplating.TextTransformation。|发生时`inherits`模板指令中的参数指定不是继承自的类`TextTransformation`。 消息可提供模板指令的行号。|指定派生自的类`TextTransformation`。|  
|模板指令中指定了无效的区域性。 区域性必须为"xx XX"格式。 将使用固定区域性。|模板指令中的区域性参数指定不正确时发生。 消息可提供模板指令的行号。|将区域性参数更改为"xx XX"格式是有效的区域性。|  
|一个无效的调试值"{0}"的 template 指令中指定。 调试值必须为"true"或"false"。 将使用默认值为"false"。|发生时`debug`错误地指定在模板指令中的参数。 消息可提供模板指令的行号。|调试参数设置为"true"或"false"。|  
|在模板指令中指定了无效的 HostSpecific 值"{0}"。 HostSpecific 值必须为"true"或"false"。 将使用默认值为"false"。|发生时中的特定于宿主的参数`template`指令未正确指定。 消息可提供模板指令的行号。|将特定于宿主的参数设置为"true"或"false"。|  
|模板指令中指定了无效的语言"{0}"。 语言必须是"C#"或"VB"。 将使用"C#"的默认值。|在未指定不受支持的语言时发生`template`指令。 只有"C#"或"VB"允许 （不区分大小写）。 消息可提供模板指令的行号。|设置`language`到"C#"或"VB"的 template 指令中的参数。|  
|在模板中找到多个输出指令。 将忽略所有但第一个。|发生时多个`output`模板文件中指定指令。 消息可提供重复的输出指令的行号。|删除重复`output`指令。|  
|在模板中找到多个模板指令。 将忽略所有但第一个。 应在一个模板指令中指定多个参数向模板指令。|如果指定多个则会发生`template`文本模板文件 （包括包含的文件） 中的指令。 消息可提供重复模板指令的行号。|聚合的不同`template`指令成一个`template`指令。|  
|任何处理器不指定名为"{0}"的指令。 将忽略该指令。|如果你指定则会发生`custom`指令，但不是提供`processor`属性。 消息可提供该指令和行号的名称。|提供`processor`具有的名称属性`directive`指令处理器。|  
|名为 {1} 指令找不到名为"{0}"的处理器。 将忽略该指令。|系统找不到时发生`directive`内指定的处理器`custom`指令。 消息可提供与指令名称、 处理器名称和该指令的行号。|设置`processor`中的指令的指令处理器的名称属性。|  
|找不到所需的参数"{0}"指令 {1}。 将忽略该指令。|系统不提供所需的指令参数时发生。 消息可提供缺少的参数的名称、 的指令的名称和行号。|提供缺少的参数。|  
|名为"{0}"的处理器不支持名为 {1} 指令。 将忽略该指令。|指令处理器不支持一个指令时发生。 消息可提供指令处理器的名称以及有问题的指令的名称和行的号。|更正指令的名称。|  
|文件"{0}"的 include 指令将导致无限循环。|显示如果圆形 include 指令指定 （例如，文件的包含文件 B，其中包含文件 A）。|未指定循环 include 指令。|  
|运行转换：|此将字符串追加到所有的错误或运行转换时生成的警告。|不适用。|  
|在块中找到意外的开始或结束标记。 请确保没有不键入开始或结束标记，并且，在模板中不包含任何嵌套的块。|当你有一个异常时，显示\<# 或 #>。 也就是说，如果你有\<# 之后另一个打开的标记的未关闭，或您具有 #> 之前它没有闭合打开标记时。 消息提供不匹配的标记的行号。|请删除不匹配的开始或结束标记，或者使用转义符。|  
|指令指定的格式错误。 将忽略该指令。 请以格式指定指令 `<#@ name [parametername="parametervalue"]*  #>`|如果指令未采用正确的格式指定，则显示由分析器。 消息提供不正确的指令的行号。|请确保所有指令都是一种形式`<#@ name [parametername="parametervalue"]*  #>`。 有关详细信息，请参阅[T4 文本模板指令](../modeling/t4-text-template-directives.md)。|  
|无法加载程序集"{0}"的已注册指令处理器 {1}<br /><br /> {2}|无法加载指令处理器，主机时发生。 此消息标识提供为指令处理器和指令处理器的名称的程序集。|请确保已正确注册指令处理器，以及该程序集是否存在。|  
|未能找到类型"{0}"中程序集 {1} 已注册指令处理器 {2}<br /><br /> {3}|无法从其程序集加载指令处理器类型时发生。 消息可提供的类型、 程序集和指令处理器的名称。|该 vshost 在注册表中查找指令处理器信息 （名称、 程序集和类型）。 请确保正确，注册指令处理器和该类型存在于程序集。|  
|时加载程序集"{0}"出现问题|当加载的程序集问题时发生。 消息可提供程序集的名称。|你可以指定要在加载程序集\<@# assembly 号 > 指令，以及通过指令处理器。 遵循此字符串的错误消息应提供有关程序集加载失败的原因的更多的数据。|  
|时出现问题，创建并初始化为名为 {1} 的指令处理器。 处理器的类型为 {0}。 将忽略该指令。|系统无法创建或初始化指令处理器时发生。 消息可提供该指令的名称和行号和处理器的类型。|请确保使用正确的指令处理器，以及指令处理器具有公共默认构造函数。 否则，使用的调试选项以找出指令处理器的 initialize （） 方法失败的原因。 有关详细信息，请参阅[疑难解答文本模板](../modeling/debugging-a-t4-text-template.md)。|  
|处理指令名为"{0}"时引发异常。|指令处理器在处理指令时引发异常时发生。|请确保指令处理器的参数正确。|  
|主机引发了异常时尝试解析程序集引用"{0}"。|它将尝试解析程序集引用时，主机将引发异常时发生。 消息可提供该程序集引用字符串。|程序集引用来自\<@# assembly 号 > 指令和指令处理器。 请确保程序集参数中提供 'name' 参数正确。|  
|尝试为指定不受支持的 {1} 值"{0}"指令 {2}|发生是 RequiresProvidesDirectiveProcessor （所有从它派生我们生成的指令处理器），提供时，不受支持，要求，或提供自变量。|请确保，name = 中的名称值对中提供要求，并提供参数是否正确。|