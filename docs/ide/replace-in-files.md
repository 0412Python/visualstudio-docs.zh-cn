---
title: "在文件中替换 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-general"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vs.findreplace.replaceinfiles"
  - "vs.replaceinfiles"
helpviewer_keywords: 
  - "文本搜索，替换文本"
  - "“查找和替换”窗口，“在文件中替换”选项卡"
  - "“在文件中替换”选项卡，“查找和替换”窗口"
ms.assetid: ca361466-53bd-44db-a28a-3a74bc03b028
caps.latest.revision: 29
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 29
---
# 在文件中替换
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

**“在文件中替换”**允许您在指定的一组文件的代码中搜索字符串或表达式，并更改找到的部分或全部匹配项。  找到的匹配项与所执行的操作在**“结果选项”**中选择的**“查找结果”**窗口中列出。  
  
> [!NOTE]
>  显示的对话框和菜单命令可能会与“帮助”中的描述不同，具体取决于您现用的设置或版本。  若要更改设置，请在“工具”菜单上选择“导入和导出设置”。  有关更多信息，请参见 [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/zh-cn/22c4debb-4e31-47a8-8f19-16f328d7dcd3)。  
  
 可以使用下列任一方法在**“查找和替换”**窗口中显示**“在文件中替换”**。  
  
### 显示“在文件中替换”  
  
1.  在**“编辑”**菜单上展开**“查找和替换”**。  
  
2.  选择**“在文件中替换”**。  
  
     \- 或 \-  
  
     如果**查找和替换** 窗口已经打开，在工具栏上，选择 **在文件中替换**。  
  
## 查找内容  
 要搜索新的文本字符串或表达式，请在框中指定它。  要搜索的任何 20 最近搜索字符串，请打开该列表，，并选择您要搜索的字符串。  选择相邻**表达式生成器**如果您希望使用一个或多个正则表达式搜索字符串中的按钮。  有关更多信息，请参见 [在 Visual Studio 中使用正则表达式](../ide/using-regular-expressions-in-visual-studio.md)。  
  
## 替换为  
 要替换的字符串中的实例**查找内容** 用另一字符串框中，输入替换字符串中的 **替换为**框。  若要删除实例中的字符串的**查找内容**框中，将此字段保留为空。  打开显示的最近搜索的 20 字符串列表。  选择相邻**表达式生成器**按钮，如果您要在替换字符串中使用一个或多个正则表达式。  有关更多信息，请参见 [在 Visual Studio 中使用正则表达式](../ide/using-regular-expressions-in-visual-studio.md)。  
  
## 查找范围  
 从**“查找范围”**下拉列表中选择的选项可确定：是仅在当前活动文件中进行**“在文件中替换”**搜索，还是在存储于某些文件夹的所有文件中进行此种搜索。  从列表中选择搜索范围中，键入文件夹路径，或单击**浏览 \(...\)** 按钮以显示 **选择搜索文件夹**对话框框，然后选择要搜索的文件夹的一组。  也可以直接在**“查找范围”**中键入路径。  
  
> [!NOTE]
>  如果选择的**“查找范围”**选项要求您搜索已经从源代码控件中签出的文件，则仅搜索已下载到您本地计算机中的那个文件版本。  
  
## 查找选项  
 可以展开或折叠**“查找选项”**部分。  可以选择或清除下列选项：  
  
 大小写匹配  
 选择此选项后，**“查找结果”**窗口将仅显示与**“查找内容”**字符串的内容和大小写都匹配的实例。  例如，如果在选择了**“大小写匹配”**的情况下搜索“MyObject”，则将只返回“MyObject”，而不会返回“myobject”或“MYOBJECT”。  
  
 全字匹配  
 选择此选项后，**“查找结果”**窗口将仅显示与**“查找内容”**字符串全字匹配的实例。  例如，搜索“MyObject”将返回“MyObject”，而不会返回“CMyObject”或“MyObjectC”。  
  
 使用正则表达式  
 当选中此复选框时，您可以使用特殊表示法定义中的文本模式**查找内容** 或 **替换为**的文本框。  这些表示法的列表，请参阅[在 Visual Studio 中使用正则表达式](../ide/using-regular-expressions-in-visual-studio.md)。  
  
 查找以下文件类型  
 此列表指示要在**“查找范围”**目录中搜索的文件类型。  如果此字段保留为空白，则将搜索**“查找范围”**目录中的所有文件。  
  
 选择列表中的任意项以输入预配置的搜索字符串，该字符串将查找那些特定类型的文件。  
  
## 结果选项  
 可以展开或折叠**“结果选项”**部分。  可以选择或清除下列选项：  
  
 “查找结果 1”窗口  
 如果选择此选项，当前的搜索结果将替换**“查找结果 1”**窗口的内容。  此窗口将自动打开以显示搜索结果。  若要手动打开此窗口，请从**“视图”**菜单中选择**“其他窗口”**，然后选择**“查找结果 1”**。  
  
 “查找结果 2”窗口  
 如果选择此选项，当前的搜索结果将替换**“查找结果 2”**窗口的内容。  此窗口将自动打开以显示搜索结果。  若要手动打开此窗口，请从**“视图”**菜单中选择**“其他窗口”**，然后选择**“查找结果 2”**。  
  
 只显示文件名  
 当选中此复选框时，查找结果窗口将列出完整的名称和包含搜索字符串的所有文件的路径。  但是，结果将不包括字符串的显示位置的代码行。  此复选框才可用于在文件中查找。  
  
 全部替换后已修改文件保持打开状态  
 选择此选项后，进行了替换操作的所有文件将会保持打开，以便撤消或保存更改。  内存约束可能会限制进行替换操作后，可保留为打开状态的文件数量。  
  
> [!CAUTION]
>  只能对保持打开状态以进行编辑的文件使用**“撤消”**。  如果未选择此选项，尚未打开进行编辑的文件将会保持关闭，而且**“撤消”**选项在那些文件中将不可用。  
  
## 请参阅  
 [查找和替换文本](../ide/finding-and-replacing-text.md)   
 [在文件中查找](../ide/find-in-files.md)   
 [Visual Studio 命令](../ide/reference/visual-studio-commands.md)